<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Белиберда</title>
    <link href="https://fonts.googleapis.com/css2?family=Metal+Mania&family=Tinos:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>

    <div class="container">

        <header class="header">
            <h1>Задание 4. Белиберда</h1>
        </header>
        <div class="hero-image" style="background-image: url('../img/bann5.png');">
        </div>

        <main class="content-block">
            <p>
                Я надеюсь вы не очень испугались этих срашных звуков! Но времени боятся у вас нет!  
            </p>
            <h3>Задание</h3>
            <p>
                Перед собой вы видите послание, где искать следующую подсказку,
                Но Мисти был видимо так зол, что вычеркнул из текста все гласные и добавил к каждой букве какую-то белиберду.
                Но, вам, я уверен, этот шифр будет по силам! Просто немного внимательности и упорства.
            </p>
            <div class="task">
                <img src="../img/task_4.png"/>
            </div>  
             <div class="hint-trigger">
                <img src="../img/ghost.png" alt="Подсказка призрака" onclick="toggleHint()" style="cursor: pointer; width: 50px; margin-top: 15px;">
                <p>Нажмите на Духа, чтобы получить подсказку!</p>
            </div>
            <div class='hint-block' id="audioHintBlock">
                <p>Я могу дать тебе <span>подсказку</span>, но вот сможешь ли ты ее услышать? Если готов, то жми на кнопку проигрывателя.</p>
                <audio controls>
                    <source src="../mp3/task4_hint.mp3" type="audio/mpeg">
                    Ваш браузер не поддерживает элемент <code>audio</code>.
                </audio>
            </div>
            <div class ='answer_block'>
                <h2 class = 'answer_header'>Ваш ответ можете написать здесь</h2>
                <div class="answer">
                    <input type="text" id="answerInput" placeholder="Введите ваш ответ здесь">
                    <button onclick="checkAnswer()">Проверить</button>
                   <p id="feedback"></p>           
                </div>   
            </div>
            <div class="buttons">
                <a href="./page4.html" class="button back-button">Вернуться назад</a>
                <a href="№" class="button forward-button disabled" id="nextButton">Идти дальше</a>

            </div>
    


        </main>

        <footer class="footer">
            <p>&copy; Старый Дух города</p>
        </footer>

    </div>
<script>
          function toggleHint() {
            const hintBlock = document.getElementById('audioHintBlock');
            const hintTrigger = document.querySelector('.hint-trigger'); // Находим контейнер с Духом

            // Проверяем, если блок подсказки скрыт (мы его всегда скрываем, если он не 'block')
            if (hintBlock.style.display === 'none' || hintBlock.style.display === '') {
                // 1. Делаем блок подсказки видимым
                hintBlock.style.display = 'block';
                
                // 2. ⭐⭐ НОВОЕ: Скрываем контейнер с Духом (кнопку) ⭐⭐
                if (hintTrigger) {
                    hintTrigger.style.display = 'none';
                }
            }
            // Здесь мы убрали блок 'else', чтобы подсказка не исчезала, если нажать второй раз.
            // Дух ушел, и игрок может слушать подсказку.
        }  
        // Функция для проверки ответа
        function checkAnswer() {
            // ... (предыдущий код получения и очистки ответа остается) ...
            let userAnswer = document.getElementById('answerInput').value;
            const correctAnswer = "почтовый ящик";
            
            let feedbackElement = document.getElementById('feedback');
            let nextButton = document.getElementById('nextButton'); // Наша кнопка "Идти дальше"

            let cleanUserAnswer = userAnswer.toLowerCase().trim();
            let cleanCorrectAnswer = correctAnswer.toLowerCase().trim();

            if (cleanUserAnswer === cleanCorrectAnswer) {
                // Правильный ответ
                feedbackElement.textContent = "✅ Верно! Вы расшифровали послание! Жмите 'Идти дальше'.";
                feedbackElement.style.color = "#375d36";

                // Убираем класс disabled и возвращаем рабочую ссылку
                nextButton.classList.remove('disabled');
                nextButton.href = './page6.html'; // Делаем кнопку рабочей
            } else {
                // Неправильный ответ
                feedbackElement.textContent = "❌ Неверно. Попробуйте еще раз!";
                feedbackElement.style.color = "red";

                // Убеждаемся, что кнопка заблокирована
                nextButton.classList.add('disabled');
                nextButton.href = '#'; // Защита от перехода
            }
        }
    </script>
</body>
</html>